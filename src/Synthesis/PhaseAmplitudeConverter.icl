implementation module Synthesis.PhaseAmplitudeConverter
import StdEnv
import Util.TypeDefs, Util.Constants


/*
Name: sineTable
Arguments: None
Output: {Real}

HardCoded 2,205 value wavetable for single period of sine function.
*/
sineTable :: {Real}
sineTable =: {0.0,0.00284951328988792,0.00569900344246176,0.0085484473205953,0.0113978217875381,0.0142471037071032,0.0170962699438552,0.0199452973632981,0.0227941628320628,0.0256428432180955,0.028491315390845,0.0313395562214509,0.0341875425829311,0.0370352513503697,0.039882659401105,0.0427297436149169,0.0455764808742147,0.0484228480642251,0.0512688220731794,0.0541143797925017,0.056959498116996,0.0598041539450343,0.0626483241787438,0.0654919857241947,0.0683351154915876,0.0711776903954408,0.0740196873547784,0.0768610832933167,0.0797018551396527,0.0825419798274503,0.0853814342956287,0.0882201954885487,0.0910582403562005,0.0938955458543907,0.0967320889449293,0.0995678465958169,0.102402795781432,0.105236913482716,0.108070176687365,0.11090256239001,0.113734047592409,0.116564609303631,0.119394224540245,0.122222870326502,0.125050523694528,0.127877161684506,0.130702761344863,0.133527299732458,0.136350753912766,0.139173100960066,0.141994317957627,0.144814381997894,0.147633270182673,0.150450959623318,0.153267427440916,0.156082650766474,0.158896606741104,0.161709272516207,0.164520625253662,0.167330642126008,0.170139300316633,0.172946577019955,0.17575244944161,0.178556894798637,0.181359890319662,0.184161413245082,0.186961440827254,0.189759950330674,0.192556919032166,0.195352324221064,0.198146143199398,0.200938353282078,0.203728931797076,0.206517856085614,0.209305103502345,0.212090651415537,0.214874477207259,0.217656558273563,0.220436872024666,0.223215395885137,0.225992107294077,0.228766983705306,0.231540002587541,0.234311141424583,0.237080377715498,0.239847688974801,0.242613052732637,0.245376446534965,0.248137847943738,0.250897234537089,0.253654583909508,0.256409873672029,0.259163081452408,0.261914184895308,0.264663161662477,0.267409989432932,0.270154645903137,0.272897108787191,0.275637355817,0.278375364742464,0.281111113331656,0.283844579371001,0.28657574066546,0.289304575038707,0.292031060333308,0.294755174410905,0.297476895152394,0.300196200458103,0.302913068247973,0.305627476461738,0.308339403059101,0.311048826019918,0.313755723344371,0.316460073053152,0.319161853187637,0.321861041810067,0.324557617003726,0.327251556873118,0.329942839544144,0.332631443164283,0.335317345902765,0.338000525950752,0.340680961521514,0.343358630850602,0.346033512196033,0.348705583838458,0.351374824081343,0.354041211251147,0.35670472369749,0.359365339793338,0.362023037935174,0.364677796543174,0.36732959406138,0.36997840895788,0.372624219724979,0.375267004879375,0.377906742962333,0.380543412539861,0.383176992202879,0.385807460567399,0.388434796274696,0.391058977991479,0.393679984410071,0.396297794248572,0.398912386251042,0.401523739187667,0.404131831854934,0.406736643075801,0.409338151699873,0.411936336603568,0.414531176690296,0.417122650890623,0.419710738162445,0.422295417491161,0.424876667889839,0.427454468399392,0.430028798088744,0.432599636054999,0.435166961423616,0.437730753348574,0.440290991012543,0.442847653627052,0.44540072043266,0.447950170699121,0.450495983725556,0.453038138840618,0.455576615402663,0.458111392799914,0.460642450450633,0.463169767803283,0.465693324336697,0.468213099560247,0.470729073014006,0.473241224268919,0.475749532926963,0.478253978621319,0.480754541016533,0.483251199808681,0.485743934725538,0.488232725526737,0.490717552003939,0.493198393980992,0.495675231314099,0.498148043891977,0.500616811636027,0.503081514500489,0.50554213247261,0.507998645572808,0.510451033854827,0.512899277405907,0.515343356346941,0.517783250832636,0.520218941051679,0.522650407226891,0.525077629615393,0.527500588508766,0.529919264233206,0.53233363714969,0.534743687654131,0.537149396177539,0.539550743186182,0.54194770918174,0.544340274701466,0.546728420318345,0.549112126641248,0.551491374315095,0.553866144021007,0.556236416476466,0.558602172435469,0.560963392688689,0.563320058063623,0.565672149424757,0.568019647673714,0.570362533749413,0.572700788628222,0.575034393324115,0.577363328888821,0.579687576411983,0.582007117021312,0.584321931882733,0.586632002200547,0.588937309217577,0.591237834215324,0.593533558514118,0.595824463473268,0.598110530491217,0.600391741005688,0.60266807649384,0.604939518472416,0.60720604849789,0.609467648166623,0.611724299115007,0.61397598301962,0.616222681597366,0.618464376605633,0.620701049842433,0.622932683146557,0.625159258397716,0.627380757516694,0.629597162465488,0.631808455247463,0.634014617907489,0.636215632532094,0.638411481249607,0.640602146230301,0.64278760968654,0.644967853872925,0.647142861086434,0.649312613666569,0.651477093995497,0.653636284498195,0.655790167642593,0.657938725939714,0.660081941943818,0.662219798252543,0.664352277507047,0.666479362392147,0.668601035636462,0.67071728001255,0.672828078337054,0.674933413470834,0.677033268319111,0.679127625831604,0.68121646900267,0.68329978087144,0.685377544521958,0.687449743083319,0.689516359729804,0.691577377681018,0.693632780202025,0.695682550603488,0.697726672241797,0.699765128519212,0.701797902883993,0.703824978830535,0.705846339899503,0.707861969677967,0.709871851799532,0.711875969944472,0.713874307839864,0.71586684925972,0.717853578025115,0.719834478004324,0.72180953311295,0.723778727314053,0.725742044618283,0.727699469084011,0.729650984817452,0.731596575972803,0.733536226752363,0.735469921406668,0.737397644234616,0.739319379583594,0.741235111849604,0.743144825477395,0.745048504960585,0.746946134841785,0.748837699712729,0.750723184214399,0.752602573037146,0.754475850920816,0.756343002654875,0.758204013078532,0.760058867080862,0.761907549600928,0.763750045627904,0.765586340201196,0.767416418410566,0.76924026539625,0.77105786634908,0.772869206510604,0.774674271173208,0.776473045680229,0.778265515426083,0.780051665856378,0.781831482468031,0.78360495080939,0.785372056480349,0.787132785132465,0.788887122469074,0.790635054245409,0.792376566268715,0.794111644398362,0.795840274545963,0.797562442675486,0.799278134803369,0.800987336998634,0.802690035382999,0.804386216130993,0.806075865470063,0.807758969680694,0.809435515096511,0.811105488104398,0.812768875144604,0.814425662710855,0.816075837350462,0.817719385664433,0.819356294307577,0.82098654998862,0.822610139470303,0.8242270495695,0.825837267157315,0.827440779159198,0.829037572555043,0.8306276343793,0.832210951721075,0.83378751172424,0.835357301587534,0.836920308564667,0.838476519964425,0.840025923150773,0.841568505542954,0.843104254615599,0.844633157898819,0.846155202978313,0.847670377495469,0.849178669147458,0.850680065687341,0.852174554924164,0.853662124723061,0.855142763005347,0.856616457748621,0.858083196986861,0.859542968810522,0.860995761366633,0.862441562858892,0.863880361547764,0.865312145750573,0.866736903841601,0.86815462425218,0.869565295470783,0.870968906043125,0.872365444572249,0.873754899718622,0.875137260200226,0.876512514792649,0.877880652329179,0.879241661700891,0.880595531856739,0.881942251803647,0.883281810606595,0.884614197388711,0.885939401331358,0.88725741167422,0.888568217715393,0.88987180881147,0.891168174377626,0.892457303887707,0.893739186874313,0.895013812928885,0.896281171701788,0.897541252902394,0.898794046299168,0.900039541719751,0.901277729051042,0.902508598239276,0.903732139290114,0.904948342268718,0.906157197299833,0.907358694567866,0.90855282431697,0.909739576851118,0.910918942534186,0.912090911790028,0.913255475102555,0.914412623015813,0.91556234613406,0.916704635121839,0.917839480704058,0.918966873666064,0.920086804853715,0.921199265173459,0.922304245592405,0.923401737138395,0.924491730900083,0.925574218026998,0.926649189729624,0.927716637279467,0.92877655200913,0.929828925312375,0.930873748644205,0.931911013520922,0.932940711520203,0.933962834281164,0.934977373504433,0.935984320952212,0.936983668448347,0.937975407878395,0.938959531189685,0.939936030391391,0.94090489755459,0.94186612481233,0.942819704359694,0.943765628453861,0.944703889414171,0.945634479622188,0.946557391521757,0.947472617619072,0.948380150482733,0.949279982743807,0.950172107095888,0.951056516295154,0.951933203160433,0.952802160573251,0.953663381477899,0.954516858881485,0.955362585853991,0.956200555528333,0.957030761100413,0.957853195829175,0.958667853036661,0.959474726108065,0.960273808491784,0.961065093699476,0.961848575306109,0.962624246950013,0.963392102332935,0.964152135220086,0.964904339440196,0.96564870888556,0.966385237512089,0.967113919339361,0.967834748450667,0.968547718993061,0.969252825177404,0.969950061278418,0.970639421634722,0.971320900648891,0.971994492787489,0.972660192581121,0.973317994624477,0.973967893576373,0.974609884159798,0.975243961161953,0.975870119434296,0.976488353892583,0.97709865951691,0.977701031351752,0.978295464506005,0.978881954153025,0.979460495530667,0.980031083941324,0.980593714751965,0.981148383394173,0.981695085364181,0.98223381622291,0.982764571596004,0.983287347173867,0.983802138711695,0.984308942029512,0.984807753012209,0.985298567609566,0.985781381836296,0.986256191772073,0.986722993561561,0.987181783414451,0.987632557605486,0.988075312474497,0.988510044426427,0.988936749931366,0.989355425524575,0.989766067806516,0.990168673442878,0.990563239164609,0.990949761767935,0.991328238114394,0.991698665130854,0.992061039809543,0.992415359208073,0.992761620449461,0.993099820722155,0.993429957280056,0.99375202744254,0.994066028594481,0.994371958186269,0.994669813733836,0.99495959281867,0.995241293087841,0.995514912254015,0.995780448095475,0.996037898456138,0.996287261245573,0.996528534439018,0.996761716077399,0.996986804267339,0.99720379718118,0.997412693056997,0.997613490198608,0.997806186975592,0.997990781823301,0.998167273242872,0.998335659801241,0.998495940131152,0.99864811293117,0.998792176965691,0.998928131064952,0.999055974125041,0.999175705107905,0.99928732304136,0.999390827019096,0.999486216200688,0.9995734898116,0.999652647143194,0.999723687552731,0.999786610463383,0.999841415364231,0.999888101810273,0.999926669422429,0.999957117887537,0.999979446958366,0.999993656453608,0.999999746257887,0.999997716321754,0.999987566661692,0.999969297360114,0.999942908565361,0.999908400491704,0.99986577341934,0.99981502769439,0.999756163728895,0.999689182000816,0.999614083054028,0.999530867498313,0.999439536009363,0.999340089328763,0.999232528263997,0.999116853688431,0.998993066541314,0.998861167827766,0.99872115861877,0.998573040051165,0.998416813327636,0.998252479716703,0.998080040552712,0.997899497235826,0.99771085123201,0.99751410407302,0.997309257356394,0.997096312745433,0.996875271969192,0.996646136822467,0.996408909165776,0.996163590925345,0.995910184093096,0.995648690726628,0.995379112949198,0.995101452949709,0.994815712982689,0.994521895368273,0.994220002492184,0.993910036805714,0.993592000825705,0.993265897134528,0.992931728380059,0.992589497275665,0.992239206600172,0.991880859197851,0.99151445797839,0.991140005916874,0.990757506053756,0.990366961494838,0.989968375411239,0.989561751039376,0.989147091680936,0.988724400702844,0.988293681537242,0.987854937681461,0.987408172697985,0.986953390214433,0.986490593923521,0.986019787583035,0.985540975015802,0.985054160109656,0.98455934681741,0.984056539156819,0.983545741210552,0.983026957126158,0.982500191116028,0.981965447457369,0.98142273049216,0.980872044627123,0.980313394333686,0.979746784147946,0.979172218670631,0.978589702567064,0.977999240567127,0.977400837465219,0.97679449812022,0.976180227455447,0.975558030458622,0.974927912181823,0.974289877741448,0.973643932318173,0.972990081156909,0.972328329566758,0.971658682920973,0.970981146656912,0.970295726275995,0.96960242734366,0.968901255489314,0.968192216406293,0.967475315851812,0.966750559646918,0.966017953676446,0.965277503888966,0.964529216296741,0.963773096975673,0.963009152065257,0.962237387768528,0.961457810352013,0.960670426145681,0.959875241542888,0.959072263000329,0.958261497037982,0.957442950239059,0.956616629249948,0.955782540780164,0.954940691602289,0.954091088551923,0.953233738527623,0.952368648490851,0.951495825465915,0.950615276539913,0.949727008862676,0.948831029646708,0.94792734616713,0.94701596576162,0.946096895830351,0.945170143835934,0.944235717303357,0.943293623819924,0.942343871035189,0.941386466660902,0.940421418470939,0.939448734301243,0.938468422049759,0.93748048967637,0.936484945202833,0.935481796712711,0.934471052351314,0.933452720325624,0.932426808904235,0.931393326417285,0.930352281256384,0.92930368187455,0.928247536786143,0.927183854566786,0.926112643853306,0.925033913343658,0.923947671796856,0.922853928032902,0.921752690932713,0.920643969438051,0.919527772551449,0.918404109336138,0.917272988915974,0.916134420475364,0.91498841325919,0.913834976572736,0.91267411978161,0.911505852311671,0.91033018364895,0.909147123339573,0.907956680989686,0.906758866265373,0.905553688892582,0.904341158657044,0.90312128540419,0.901894079039078,0.900659549526307,0.899417706889939,0.898168561213417,0.896912122639482,0.89564840137009,0.894377407666335,0.893099151848356,0.891813644295263,0.890520895445045,0.889220915794491,0.8879137158991,0.886599306372998,0.885277697888853,0.883948901177785,0.882612927029281,0.881269786291108,0.879919489869222,0.878562048727681,0.87719747388856,0.875825776431854,0.874446967495393,0.873061058274751,0.871668060023154,0.870267984051388,0.86886084172771,0.867446644477754,0.866025403784436,0.864597131187866,0.863161838285249,0.861719536730793,0.860270238235616,0.858813954567648,0.857350697551538,0.855880479068556,0.854403311056497,0.852919205509586,0.851428174478376,0.849930230069657,0.84842538444635,0.846913649827415,0.845395038487748,0.843869562758081,0.842337235024884,0.840798067730266,0.839252073371866,0.837699264502761,0.83613965373136,0.8345732537213,0.833000077191346,0.831420136915286,0.829833445721829,0.828240016494498,0.826639862171528,0.825032995745761,0.823419430264536,0.821799178829593,0.820172254596953,0.818538670776824,0.816898440633484,0.815251577485182,0.81359809470402,0.811938005715854,0.810271324000178,0.808598063090019,0.806918236571825,0.805231858085353,0.803538941323564,0.801839500032506,0.800133548011203,0.798421099111548,0.796702167238184,0.794976766348395,0.793244910451992,0.791506613611199,0.789761889940539,0.788010753606719,0.786253218828514,0.784489299876655,0.782719011073709,0.780942366793965,0.779159381463318,0.777370069559149,0.775574445610209,0.773772524196504,0.77196431994917,0.77014984755036,0.768329121733125,0.766502157281286,0.764668969029327,0.762829571862263,0.760983980715526,0.75913221057484,0.757274276476102,0.755410193505259,0.753539976798184,0.751663641540555,0.749781202967731,0.747892676364629,0.745998077065598,0.744097420454297,0.742190721963568,0.740277997075312,0.738359261320362,0.736434530278358,0.734503819577622,0.732567144895025,0.730624521955869,0.728675966533751,0.72672149445044,0.724761121575744,0.722794863827388,0.720822737170878,0.718844757619374,0.71686094123356,0.714871304121517,0.712875862438583,0.710874632387232,0.708867630216935,0.706854872224035,0.704836374751608,0.702812154189333,0.70078222697336,0.698746609586175,0.696705318556467,0.694658370458993,0.692605781914446,0.690547569589316,0.688483750195754,0.686414340491447,0.684339357279465,0.682258817408138,0.680172737770915,0.678081135306226,0.675984026997342,0.673881429872244,0.67177336100348,0.669659837508024,0.667540876547144,0.665416495326257,0.663286711094792,0.661151541146047,0.659011002817054,0.656865113488431,0.654713890584249,0.652557351571882,0.650395513961872,0.648228395307784,0.646056013206064,0.643878385295893,0.641695529259051,0.639507462819766,0.637314203744574,0.635115769842174,0.632912178963284,0.630703449000493,0.628489597888119,0.626270643602065,0.624046604159667,0.621817497619553,0.619583342081494,0.617344155686257,0.61509995661546,0.61285076309142,0.61059659337701,0.608337465775509,0.606073398630449,0.603804410325473,0.601530519284182,0.599251743969985,0.596968102885952,0.594679614574659,0.592386297618043,0.590088170637247,0.587785252292469,0.585477561282813,0.583165116346137,0.580847936258898,0.578526039836001,0.576199445930648,0.573868173434181,0.571532241275933,0.569191668423072,0.566846473880445,0.56449667669043,0.562142295932774,0.559783350724443,0.557419860219463,0.55505184360877,0.552679320120049,0.550302309017578,0.547920829602077,0.545534901210544,0.543144543216104,0.540749775027848,0.538350616090677,0.535947085885145,0.533539203927296,0.531126989768512,0.528710462995353,0.526289643229391,0.52386455012706,0.521435203379493,0.519001622712359,0.516563827885705,0.514121838693799,0.511675674964964,0.509225356561418,0.506770903379117,0.504312335347589,0.501849672429773,0.499382934621856,0.496912141953116,0.494437314485752,0.491958472314725,0.489475635567597,0.486988824404362,0.484498059017286,0.482003359630743,0.479504746501049,0.477002239916299,0.474495860196203,0.471985627691918,0.469471562785886,0.466953685891666,0.46443201745377,0.461906577947497,0.459377387878765,0.456844467783946,0.454307838229699,0.451767519812803,0.449223533159989,0.446675898927773,0.444124637802289,0.441569770499121,0.439011317763134,0.436449300368304,0.433883739117553,0.431314654842577,0.42874206840368,0.426166000689601,0.423586472617346,0.421003505132018,0.41841711920665,0.415827335842027,0.413234176066525,0.410637660935933,0.408037811533284,0.405434648968687,0.402828194379152,0.400218468928417,0.397605493806783,0.394989290230933,0.392369879443767,0.389747282714227,0.387121521337123,0.384492616632959,0.381860589947766,0.379225462652923,0.376587256144984,0.373945991845507,0.371301691200878,0.368654375682137,0.366004066784804,0.363350786028706,0.360694554957798,0.358035395139992,0.355373328166983,0.352708375654067,0.350040559239974,0.347369900586685,0.34469642137926,0.342020143325663,0.339341088156582,0.336659277625255,0.333974733507293,0.331287477600503,0.32859753172471,0.325904917721583,0.323209657454454,0.320511772808142,0.317811285688776,0.315108218023615,0.312402591760873,0.309694428869538,0.306983751339196,0.30427058117985,0.301554940421743,0.29883685111518,0.296116335330343,0.293393415157123,0.290668112704928,0.287940450102513,0.285210449497796,0.282478133057679,0.279743522967867,0.277006641432692,0.274267510674924,0.271526152935602,0.268782590473843,0.266036845566669,0.26328894050882,0.26053889761258,0.257786739207587,0.255032487640658,0.252276165275608,0.249517794493065,0.246757397690287,0.243994997280988,0.241230615695146,0.238464275378829,0.235695998794006,0.232925808418372,0.230153726745159,0.227379776282955,0.224603979555525,0.221826359101622,0.219046937474811,0.216265737243277,0.213482780989652,0.210698091310823,0.207911690817753,0.205123602135297,0.202333847902016,0.199542450769998,0.196749433404667,0.193954818484605,0.191158628701366,0.188360886759291,0.185561615375323,0.182760837278826,0.179958575211396,0.17715485192668,0.174349690190189,0.171543112779113,0.168735142482139,0.165925802099261,0.163115114441602,0.160303102331219,0.157489788600929,0.154675196094113,0.151859347664538,0.149042266176168,0.146223974502979,0.143404495528774,0.140583852146997,0.137762067260543,0.134939163781582,0.132115164631361,0.129290092740027,0.126463971046435,0.123636822497967,0.12080867005034,0.117979536667423,0.115149445321053,0.11231841899084,0.10948648066399,0.106653653335113,0.103819960006038,0.100985423685624,0.0981500673895754,0.0953139141402568,0.0924769869665011,0.0896393089034265,0.0868009029922488,0.083961792280092,0.0811219998198049,0.07828154866977,0.0754404618937196,0.0725987625605471,0.0697564737441184,0.0669136185230872,0.0640702199807061,0.0612263012046387,0.0583818852867722,0.0555369953230329,0.052691654413194,0.0498458856606899,0.0469997121724319,0.0441531570586148,0.0413062434325326,0.0384589944103913,0.0356114331111201,0.0327635826561825,0.0299154661693913,0.0270671067767193,0.0242185276061104,0.0213697517872943,0.0185208024515975,0.0156717027317539,0.0128224757617205,0.00997314467648556,0.0071237326118847,0.00427426270440914,0.00142475809102117,-0.00142475809103514,-0.00427426270442311,-0.00712373261189822,-0.00997314467649953,-0.0128224757617344,-0.0156717027317678,-0.0185208024516114,-0.0213697517873087,-0.0242185276061244,-0.0270671067767329,-0.0299154661694057,-0.0327635826561965,-0.0356114331111336,-0.0384589944104057,-0.0413062434325466,-0.0441531570586283,-0.0469997121724459,-0.0498458856607043,-0.0526916544132075,-0.0555369953230469,-0.0583818852867865,-0.0612263012046522,-0.0640702199807201,-0.0669136185231011,-0.0697564737441324,-0.0725987625605611,-0.0754404618937335,-0.0782815486697839,-0.0811219998198188,-0.0839617922801059,-0.0868009029922627,-0.0896393089034409,-0.092476986966515,-0.0953139141402703,-0.0981500673895897,-0.100985423685637,-0.103819960006051,-0.106653653335128,-0.109486480664004,-0.112318418990854,-0.115149445321067,-0.117979536667438,-0.120808670050354,-0.123636822497981,-0.126463971046449,-0.12929009274004,-0.132115164631375,-0.134939163781595,-0.137762067260557,-0.14058385214701,-0.143404495528788,-0.146223974502993,-0.149042266176182,-0.151859347664552,-0.154675196094126,-0.157489788600943,-0.160303102331233,-0.163115114441615,-0.165925802099275,-0.168735142482152,-0.171543112779126,-0.174349690190202,-0.177154851926694,-0.17995857521141,-0.18276083727884,-0.185561615375337,-0.188360886759304,-0.19115862870138,-0.193954818484619,-0.19674943340468,-0.199542450770011,-0.20233384790203,-0.205123602135311,-0.207911690817766,-0.210698091310836,-0.213482780989666,-0.216265737243291,-0.219046937474824,-0.221826359101636,-0.224603979555538,-0.227379776282969,-0.230153726745172,-0.232925808418386,-0.23569599879402,-0.238464275378842,-0.241230615695159,-0.243994997281002,-0.246757397690301,-0.249517794493078,-0.252276165275622,-0.255032487640672,-0.2577867392076,-0.260538897612593,-0.263288940508834,-0.266036845566682,-0.268782590473857,-0.271526152935615,-0.274267510674938,-0.277006641432705,-0.279743522967881,-0.282478133057692,-0.285210449497809,-0.287940450102526,-0.290668112704941,-0.293393415157136,-0.296116335330356,-0.298836851115192,-0.301554940421757,-0.304270581179864,-0.306983751339209,-0.309694428869552,-0.312402591760886,-0.315108218023628,-0.317811285688789,-0.320511772808155,-0.323209657454467,-0.325904917721596,-0.328597531724724,-0.331287477600516,-0.333974733507306,-0.336659277625268,-0.339341088156595,-0.342020143325676,-0.344696421379273,-0.347369900586698,-0.350040559239987,-0.35270837565408,-0.355373328166996,-0.358035395140006,-0.360694554957811,-0.363350786028719,-0.366004066784818,-0.36865437568215,-0.371301691200891,-0.37394599184552,-0.376587256144997,-0.379225462652936,-0.381860589947779,-0.384492616632972,-0.387121521337135,-0.38974728271424,-0.392369879443781,-0.394989290230946,-0.397605493806795,-0.40021846892843,-0.402828194379164,-0.4054346489687,-0.408037811533297,-0.410637660935946,-0.413234176066538,-0.41582733584204,-0.418417119206662,-0.421003505132031,-0.423586472617359,-0.426166000689613,-0.428742068403693,-0.43131465484259,-0.433883739117565,-0.436449300368316,-0.439011317763147,-0.441569770499134,-0.444124637802302,-0.446675898927786,-0.449223533160001,-0.451767519812815,-0.454307838229712,-0.456844467783959,-0.459377387878777,-0.461906577947509,-0.464432017453783,-0.466953685891678,-0.469471562785898,-0.47198562769193,-0.474495860196215,-0.477002239916311,-0.479504746501061,-0.482003359630755,-0.484498059017298,-0.486988824404374,-0.48947563556761,-0.491958472314738,-0.494437314485764,-0.496912141953128,-0.499382934621868,-0.501849672429785,-0.504312335347601,-0.50677090337913,-0.50922535656143,-0.511675674964975,-0.514121838693811,-0.516563827885717,-0.51900162271237,-0.521435203379505,-0.523864550127073,-0.526289643229403,-0.528710462995365,-0.531126989768524,-0.533539203927308,-0.535947085885157,-0.538350616090689,-0.54074977502786,-0.543144543216115,-0.545534901210556,-0.547920829602088,-0.550302309017589,-0.55267932012006,-0.555051843608782,-0.557419860219475,-0.559783350724454,-0.562142295932786,-0.564496676690442,-0.566846473880457,-0.569191668423083,-0.571532241275944,-0.573868173434192,-0.576199445930659,-0.578526039836012,-0.58084793625891,-0.583165116346148,-0.585477561282824,-0.58778525229248,-0.590088170637257,-0.592386297618054,-0.594679614574671,-0.596968102885963,-0.599251743969996,-0.601530519284194,-0.603804410325484,-0.60607339863046,-0.60833746577552,-0.610596593377022,-0.612850763091431,-0.61509995661547,-0.617344155686268,-0.619583342081505,-0.621817497619564,-0.624046604159678,-0.626270643602076,-0.62848959788813,-0.630703449000503,-0.632912178963295,-0.635115769842185,-0.637314203744585,-0.639507462819777,-0.641695529259062,-0.643878385295904,-0.646056013206074,-0.648228395307795,-0.650395513961883,-0.652557351571892,-0.654713890584259,-0.656865113488442,-0.659011002817064,-0.661151541146058,-0.663286711094802,-0.665416495326267,-0.667540876547155,-0.669659837508034,-0.67177336100349,-0.673881429872255,-0.675984026997352,-0.678081135306236,-0.680172737770926,-0.682258817408148,-0.684339357279475,-0.686414340491457,-0.688483750195765,-0.690547569589325,-0.692605781914456,-0.694658370459003,-0.696705318556477,-0.698746609586185,-0.70078222697337,-0.702812154189343,-0.704836374751618,-0.706854872224045,-0.708867630216945,-0.710874632387241,-0.712875862438592,-0.714871304121526,-0.71686094123357,-0.718844757619383,-0.720822737170887,-0.722794863827398,-0.724761121575754,-0.726721494450449,-0.72867596653376,-0.730624521955879,-0.732567144895035,-0.734503819577631,-0.736434530278368,-0.738359261320371,-0.740277997075321,-0.742190721963578,-0.744097420454306,-0.745998077065607,-0.747892676364638,-0.74978120296774,-0.751663641540564,-0.753539976798193,-0.755410193505268,-0.757274276476111,-0.759132210574849,-0.760983980715535,-0.762829571862273,-0.764668969029336,-0.766502157281295,-0.768329121733134,-0.770149847550369,-0.771964319949179,-0.773772524196513,-0.775574445610217,-0.777370069559157,-0.779159381463327,-0.780942366793974,-0.782719011073718,-0.784489299876664,-0.786253218828523,-0.788010753606728,-0.789761889940548,-0.791506613611207,-0.793244910452001,-0.794976766348403,-0.796702167238192,-0.798421099111556,-0.800133548011212,-0.801839500032514,-0.803538941323573,-0.805231858085362,-0.806918236571833,-0.808598063090027,-0.810271324000186,-0.811938005715862,-0.813598094704028,-0.81525157748519,-0.816898440633492,-0.818538670776832,-0.820172254596961,-0.821799178829601,-0.823419430264544,-0.825032995745768,-0.826639862171536,-0.828240016494506,-0.829833445721837,-0.831420136915294,-0.833000077191354,-0.834573253721308,-0.836139653731368,-0.837699264502769,-0.839252073371873,-0.840798067730273,-0.842337235024892,-0.843869562758089,-0.845395038487755,-0.846913649827422,-0.848425384446358,-0.849930230069664,-0.851428174478384,-0.852919205509593,-0.854403311056504,-0.855880479068563,-0.857350697551546,-0.858813954567655,-0.860270238235623,-0.8617195367308,-0.863161838285255,-0.864597131187873,-0.866025403784443,-0.867446644477761,-0.868860841727717,-0.870267984051395,-0.871668060023161,-0.873061058274758,-0.8744469674954,-0.875825776431861,-0.877197473888567,-0.878562048727688,-0.879919489869228,-0.881269786291115,-0.882612927029288,-0.883948901177792,-0.885277697888859,-0.886599306373005,-0.887913715899106,-0.889220915794497,-0.890520895445052,-0.89181364429527,-0.893099151848363,-0.894377407666341,-0.895648401370097,-0.896912122639488,-0.898168561213423,-0.899417706889945,-0.900659549526313,-0.901894079039084,-0.903121285404196,-0.90434115865705,-0.905553688892588,-0.906758866265379,-0.907956680989692,-0.909147123339579,-0.910330183648956,-0.911505852311677,-0.912674119781616,-0.913834976572742,-0.914988413259196,-0.91613442047537,-0.91727298891598,-0.918404109336144,-0.919527772551454,-0.920643969438056,-0.921752690932719,-0.922853928032907,-0.923947671796862,-0.925033913343664,-0.926112643853311,-0.927183854566791,-0.928247536786148,-0.929303681874555,-0.930352281256389,-0.93139332641729,-0.93242680890424,-0.933452720325629,-0.934471052351319,-0.935481796712716,-0.936484945202838,-0.937480489676375,-0.938468422049764,-0.939448734301248,-0.940421418470944,-0.941386466660906,-0.942343871035194,-0.943293623819928,-0.944235717303362,-0.945170143835939,-0.946096895830355,-0.947015965761624,-0.947927346167135,-0.948831029646713,-0.94972700886268,-0.950615276539917,-0.951495825465919,-0.952368648490855,-0.953233738527627,-0.954091088551927,-0.954940691602293,-0.955782540780168,-0.956616629249952,-0.957442950239063,-0.958261497037986,-0.959072263000333,-0.959875241542892,-0.960670426145685,-0.961457810352017,-0.962237387768532,-0.963009152065261,-0.963773096975677,-0.964529216296745,-0.96527750388897,-0.96601795367645,-0.966750559646922,-0.967475315851816,-0.968192216406297,-0.968901255489318,-0.969602427343663,-0.970295726275999,-0.970981146656915,-0.971658682920976,-0.972328329566762,-0.972990081156912,-0.973643932318177,-0.974289877741451,-0.974927912181826,-0.975558030458625,-0.97618022745545,-0.976794498120223,-0.977400837465222,-0.97799924056713,-0.978589702567067,-0.979172218670634,-0.979746784147949,-0.980313394333689,-0.980872044627126,-0.981422730492163,-0.981965447457372,-0.982500191116031,-0.98302695712616,-0.983545741210554,-0.984056539156821,-0.984559346817412,-0.985054160109659,-0.985540975015804,-0.986019787583037,-0.986490593923523,-0.986953390214435,-0.987408172697988,-0.987854937681463,-0.988293681537245,-0.988724400702846,-0.989147091680938,-0.989561751039378,-0.989968375411241,-0.990366961494839,-0.990757506053758,-0.991140005916876,-0.991514457978392,-0.991880859197853,-0.992239206600173,-0.992589497275666,-0.992931728380061,-0.993265897134529,-0.993592000825707,-0.993910036805716,-0.994220002492185,-0.994521895368274,-0.994815712982691,-0.995101452949711,-0.995379112949199,-0.995648690726629,-0.995910184093098,-0.996163590925346,-0.996408909165777,-0.996646136822468,-0.996875271969193,-0.997096312745434,-0.997309257356395,-0.997514104073021,-0.997710851232011,-0.997899497235827,-0.998080040552713,-0.998252479716703,-0.998416813327637,-0.998573040051166,-0.998721158618771,-0.998861167827767,-0.998993066541315,-0.999116853688432,-0.999232528263997,-0.999340089328764,-0.999439536009363,-0.999530867498314,-0.999614083054028,-0.999689182000817,-0.999756163728895,-0.99981502769439,-0.999865773419341,-0.999908400491705,-0.999942908565361,-0.999969297360114,-0.999987566661692,-0.999997716321754,-0.999999746257887,-0.999993656453608,-0.999979446958366,-0.999957117887537,-0.999926669422428,-0.999888101810273,-0.999841415364231,-0.999786610463383,-0.999723687552731,-0.999652647143194,-0.9995734898116,-0.999486216200688,-0.999390827019095,-0.999287323041359,-0.999175705107904,-0.99905597412504,-0.998928131064951,-0.99879217696569,-0.998648112931169,-0.998495940131151,-0.99833565980124,-0.998167273242871,-0.9979907818233,-0.997806186975591,-0.997613490198607,-0.997412693056996,-0.997203797181179,-0.996986804267338,-0.996761716077398,-0.996528534439017,-0.996287261245572,-0.996037898456136,-0.995780448095474,-0.995514912254014,-0.99524129308784,-0.994959592818669,-0.994669813733834,-0.994371958186268,-0.994066028594479,-0.993752027442539,-0.993429957280054,-0.993099820722153,-0.992761620449459,-0.992415359208071,-0.992061039809541,-0.991698665130852,-0.991328238114392,-0.990949761767933,-0.990563239164607,-0.990168673442876,-0.989766067806514,-0.989355425524573,-0.988936749931364,-0.988510044426425,-0.988075312474494,-0.987632557605484,-0.987181783414448,-0.986722993561559,-0.986256191772071,-0.985781381836294,-0.985298567609563,-0.984807753012206,-0.98430894202951,-0.983802138711692,-0.983287347173864,-0.982764571596002,-0.982233816222908,-0.981695085364179,-0.981148383394171,-0.980593714751963,-0.980031083941322,-0.979460495530664,-0.978881954153022,-0.978295464506002,-0.977701031351749,-0.977098659516907,-0.97648835389258,-0.975870119434292,-0.975243961161949,-0.974609884159795,-0.97396789357637,-0.973317994624473,-0.972660192581118,-0.971994492787485,-0.971320900648888,-0.970639421634719,-0.969950061278414,-0.969252825177401,-0.968547718993057,-0.967834748450664,-0.967113919339357,-0.966385237512085,-0.965648708885556,-0.964904339440192,-0.964152135220082,-0.963392102332931,-0.962624246950009,-0.961848575306105,-0.961065093699472,-0.96027380849178,-0.959474726108061,-0.958667853036657,-0.957853195829171,-0.957030761100409,-0.956200555528329,-0.955362585853987,-0.954516858881481,-0.953663381477895,-0.952802160573247,-0.951933203160429,-0.95105651629515,-0.950172107095883,-0.949279982743803,-0.948380150482729,-0.947472617619068,-0.946557391521752,-0.945634479622183,-0.944703889414167,-0.943765628453856,-0.942819704359689,-0.941866124812325,-0.940904897554585,-0.939936030391386,-0.93895953118968,-0.93797540787839,-0.936983668448342,-0.935984320952207,-0.934977373504428,-0.933962834281159,-0.932940711520198,-0.931911013520917,-0.9308737486442,-0.929828925312371,-0.928776552009124,-0.927716637279462,-0.926649189729619,-0.925574218026992,-0.924491730900077,-0.92340173713839,-0.922304245592399,-0.921199265173454,-0.92008680485371,-0.918966873666058,-0.917839480704053,-0.916704635121834,-0.915562346134054,-0.914412623015808,-0.913255475102549,-0.912090911790022,-0.91091894253418,-0.909739576851112,-0.908552824316964,-0.90735869456786,-0.906157197299827,-0.904948342268713,-0.903732139290108,-0.90250859823927,-0.901277729051036,-0.900039541719745,-0.898794046299162,-0.897541252902388,-0.896281171701781,-0.895013812928879,-0.893739186874307,-0.8924573038877,-0.89116817437762,-0.889871808811463,-0.888568217715387,-0.887257411674214,-0.885939401331352,-0.884614197388705,-0.883281810606589,-0.88194225180364,-0.880595531856732,-0.879241661700884,-0.877880652329172,-0.876512514792642,-0.875137260200219,-0.873754899718615,-0.872365444572242,-0.870968906043119,-0.869565295470776,-0.868154624252173,-0.866736903841595,-0.865312145750566,-0.863880361547756,-0.862441562858885,-0.860995761366625,-0.859542968810515,-0.858083196986854,-0.856616457748614,-0.85514276300534,-0.853662124723054,-0.852174554924157,-0.850680065687333,-0.84917866914745,-0.847670377495461,-0.846155202978306,-0.844633157898811,-0.843104254615591,-0.841568505542947,-0.840025923150765,-0.838476519964418,-0.836920308564659,-0.835357301587526,-0.833787511724233,-0.832210951721067,-0.830627634379292,-0.829037572555035,-0.82744077915919,-0.825837267157308,-0.824227049569492,-0.822610139470295,-0.820986549988612,-0.819356294307569,-0.817719385664424,-0.816075837350454,-0.814425662710847,-0.812768875144595,-0.81110548810439,-0.809435515096502,-0.807758969680685,-0.806075865470055,-0.804386216130984,-0.802690035382991,-0.800987336998626,-0.79927813480336,-0.797562442675477,-0.795840274545955,-0.794111644398354,-0.792376566268707,-0.790635054245401,-0.788887122469065,-0.787132785132456,-0.78537205648034,-0.783604950809381,-0.781831482468022,-0.780051665856369,-0.778265515426075,-0.77647304568022,-0.774674271173199,-0.772869206510596,-0.771057866349071,-0.769240265396241,-0.767416418410557,-0.765586340201187,-0.763750045627894,-0.761907549600919,-0.760058867080853,-0.758204013078523,-0.756343002654866,-0.754475850920806,-0.752602573037137,-0.75072318421439,-0.74883769971272,-0.746946134841776,-0.745048504960575,-0.743144825477386,-0.741235111849595,-0.739319379583584,-0.737397644234607,-0.735469921406659,-0.733536226752353,-0.731596575972793,-0.729650984817443,-0.727699469084001,-0.725742044618274,-0.723778727314043,-0.72180953311294,-0.719834478004314,-0.717853578025105,-0.71586684925971,-0.713874307839855,-0.711875969944462,-0.709871851799522,-0.707861969677958,-0.705846339899493,-0.703824978830524,-0.701797902883983,-0.699765128519202,-0.697726672241787,-0.695682550603478,-0.693632780202015,-0.691577377681008,-0.689516359729794,-0.687449743083309,-0.685377544521948,-0.68329978087143,-0.68121646900266,-0.679127625831594,-0.677033268319101,-0.674933413470823,-0.672828078337044,-0.67071728001254,-0.668601035636451,-0.666479362392137,-0.664352277507037,-0.662219798252533,-0.660081941943807,-0.657938725939703,-0.655790167642582,-0.653636284498184,-0.651477093995486,-0.649312613666558,-0.647142861086424,-0.644967853872915,-0.64278760968653,-0.64060214623029,-0.638411481249596,-0.636215632532084,-0.634014617907478,-0.631808455247452,-0.629597162465477,-0.627380757516682,-0.625159258397706,-0.622932683146546,-0.620701049842422,-0.618464376605622,-0.616222681597355,-0.613975983019608,-0.611724299114997,-0.609467648166611,-0.607206048497878,-0.604939518472405,-0.602668076493829,-0.600391741005677,-0.598110530491206,-0.595824463473257,-0.593533558514107,-0.591237834215313,-0.588937309217565,-0.586632002200535,-0.584321931882722,-0.5820071170213,-0.579687576411972,-0.577363328888809,-0.575034393324103,-0.572700788628211,-0.570362533749402,-0.568019647673702,-0.565672149424745,-0.563320058063612,-0.560963392688677,-0.558602172435458,-0.556236416476454,-0.553866144020996,-0.551491374315083,-0.549112126641236,-0.546728420318333,-0.544340274701454,-0.541947709181728,-0.539550743186171,-0.537149396177527,-0.534743687654119,-0.532333637149678,-0.529919264233194,-0.527500588508754,-0.525077629615382,-0.522650407226878,-0.520218941051667,-0.517783250832624,-0.515343356346928,-0.512899277405896,-0.510451033854815,-0.507998645572795,-0.505542132472599,-0.503081514500476,-0.500616811636014,-0.498148043891965,-0.495675231314086,-0.493198393980979,-0.490717552003927,-0.488232725526725,-0.485743934725525,-0.483251199808669,-0.48075454101652,-0.478253978621307,-0.475749532926951,-0.473241224268906,-0.470729073013994,-0.468213099560235,-0.465693324336684,-0.46316976780327,-0.460642450450621,-0.458111392799902,-0.45557661540265,-0.453038138840605,-0.450495983725543,-0.447950170699108,-0.445400720432648,-0.44284765362704,-0.44029099101253,-0.437730753348562,-0.435166961423604,-0.432599636054986,-0.430028798088731,-0.42745446839938,-0.424876667889827,-0.422295417491148,-0.419710738162432,-0.41712265089061,-0.414531176690283,-0.411936336603556,-0.40933815169986,-0.406736643075789,-0.404131831854921,-0.401523739187655,-0.39891238625103,-0.396297794248559,-0.393679984410058,-0.391058977991467,-0.388434796274682,-0.385807460567386,-0.383176992202866,-0.380543412539847,-0.37790674296232,-0.375267004879362,-0.372624219724965,-0.369978408957867,-0.367329594061367,-0.36467779654316,-0.362023037935162,-0.359365339793325,-0.356704723697476,-0.354041211251134,-0.35137482408133,-0.348705583838444,-0.34603351219602,-0.343358630850589,-0.3406809615215,-0.33800052595074,-0.335317345902752,-0.33263144316427,-0.329942839544131,-0.327251556873104,-0.324557617003713,-0.321861041810054,-0.319161853187623,-0.316460073053139,-0.313755723344358,-0.311048826019904,-0.308339403059088,-0.305627476461725,-0.302913068247959,-0.300196200458089,-0.297476895152381,-0.294755174410891,-0.292031060333294,-0.289304575038693,-0.286575740665447,-0.283844579370988,-0.281111113331642,-0.278375364742451,-0.275637355816986,-0.272897108787178,-0.270154645903124,-0.267409989432918,-0.264663161662464,-0.261914184895295,-0.259163081452395,-0.256409873672015,-0.253654583909495,-0.250897234537075,-0.248137847943726,-0.245376446534952,-0.242613052732623,-0.239847688974788,-0.237080377715485,-0.234311141424569,-0.231540002587528,-0.228766983705292,-0.225992107294063,-0.223215395885124,-0.220436872024652,-0.217656558273548,-0.214874477207246,-0.212090651415523,-0.209305103502331,-0.206517856085601,-0.203728931797062,-0.200938353282064,-0.198146143199385,-0.19535232422105,-0.192556919032152,-0.18975995033066,-0.18696144082724,-0.184161413245068,-0.181359890319648,-0.178556894798623,-0.175752449441596,-0.172946577019941,-0.170139300316619,-0.167330642125994,-0.164520625253648,-0.161709272516193,-0.15889660674109,-0.15608265076646,-0.153267427440903,-0.150450959623304,-0.147633270182659,-0.144814381997881,-0.141994317957613,-0.139173100960052,-0.136350753912752,-0.133527299732444,-0.130702761344849,-0.127877161684493,-0.125050523694514,-0.122222870326489,-0.119394224540231,-0.116564609303617,-0.113734047592396,-0.110902562389996,-0.10807017668735,-0.105236913482703,-0.102402795781418,-0.0995678465958023,-0.0967320889449158,-0.0938955458543766,-0.0910582403561858,-0.0882201954885351,-0.0853814342956145,-0.0825419798274364,-0.0797018551396391,-0.0768610832933025,-0.0740196873547644,-0.0711776903954272,-0.0683351154915733,-0.0654919857241807,-0.0626483241787301,-0.0598041539450199,-0.0569594981169819,-0.0541143797924879,-0.051268822073165,-0.0484228480642109,-0.0455764808742008,-0.0427297436149024,-0.0398826594010908,-0.0370352513503557,-0.0341875425829174,-0.0313395562214366,-0.028491315390831,-0.0256428432180817,-0.0227941628320493,-0.019945297363284,-0.0170962699438414,-0.0142471037070896,-0.0113978217875239,-0.0085484473205814,-0.00569900344244813,-0.00284951328987368}

sineTableSize :: !Int
sineTableSize = 2205

generateLocal :: !Int !Wave !Frequency -> Real
generateLocal _ Silence _ = 0.0
generateLocal localIndex Sine freq = sin actualPhase
where
    cycleSize = (toReal SAMPLING_RATE)/freq
    tableSize = sineTableSize
    actualPhase = (((toReal localIndex))/cycleSize) * (toReal tableSize)

generateLocal localIndex Square freq = sampleOut
where
    cycleSize = (toReal SAMPLING_RATE)/freq
    tableSize = sineTableSize
    actualPhase = ( (toReal localIndex) /cycleSize) * (toReal tableSize)
    phase = toInt actualPhase
    sampleOut | (phase rem tableSize) < (tableSize/2) = -1.0 = 1.0
generateLocal localIndex Triangle freq = sampleOut
where
    cycleSize = (toReal SAMPLING_RATE)/freq
    tableSize = toReal(sineTableSize)
    actualPhase = ((toReal localIndex)/cycleSize) * (toReal tableSize)
    phase = actualPhase remReal (toReal tableSize)
    sampleOut
    | phase <= (0.5*tableSize) = (phase - (0.25*tableSize))/tableSize
    = (((tableSize - phase)-(0.25*tableSize))*4.0)/tableSize
generateLocal localIndex Pulse freq = 0.0
generateLocal localIndex Sawtooth freq = sampleOut
where
    cycleSize = (toReal SAMPLING_RATE)/freq
    tableSize = toReal(sineTableSize)
    actualPhase = ((toReal localIndex)/cycleSize) * (toReal tableSize)
    phase = actualPhase remReal (toReal tableSize)
    sampleOut = phase/tableSize

(remReal) :: !Real !Real -> Real
(remReal) x y = result
where
    a = x/y
    b = toReal(toInt a)
    c = a - b
    result
    | x > y = x + (y*(c-b))
    = x
